<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workflows - lmapp</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="workflow-manager.css">
</head>
<body class="dark">
  <div class="app-container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <h1>lmapp</h1>
        <p class="subtitle">Workflows</p>
      </div>

      <nav class="sidebar-nav">
        <a href="index.html" class="nav-item">
          <span class="nav-icon">üí¨</span>
          <span>Chat</span>
        </a>
        <a href="workflows.html" class="nav-item active">
          <span class="nav-icon">‚ö°</span>
          <span>Workflows</span>
        </a>
        <a href="files.html" class="nav-item">
          <span class="nav-icon">üìÅ</span>
          <span>Files</span>
        </a>
        <a href="settings.html" class="nav-item">
          <span class="nav-icon">‚öôÔ∏è</span>
          <span>Settings</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="status" id="status">
          <span class="status-indicator"></span>
          <span class="status-text">Checking...</span>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="content-header">
        <h2>Preset Workflows</h2>
        <p class="subtitle">One-click automation for common tasks</p>
      </div>

      <!-- Workflow Categories -->
      <div class="workflow-categories">
        <button class="category-btn active" data-category="all">All</button>
        <button class="category-btn" data-category="productivity">Productivity</button>
        <button class="category-btn" data-category="research">Research</button>
        <button class="category-btn" data-category="gaming">Gaming</button>
        <button class="category-btn" data-category="creative">Creative</button>
      </div>

      <!-- Workflow List -->
      <div class="workflow-list" id="workflowList">
        <!-- Workflows render here dynamically -->
        <div class="loading-state">
          <div class="spinner"></div>
          <p>Loading workflows...</p>
        </div>
      </div>

      <!-- Empty State (if no workflows) -->
      <div id="emptyState" style="display: none;">
        <div class="empty-workflows">
          <div class="empty-icon">‚ö°</div>
          <h3>No Workflows Available</h3>
          <p>Workflows are preset automation templates that help you complete common tasks quickly.</p>
          <button class="btn-primary" id="createWorkflowBtn">Create Custom Workflow</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Workflow Execution Panel (Overlay) -->
  <div id="workflowPanel" style="display: none;">
    <!-- Panel content renders dynamically -->
  </div>

  <script src="workflow-manager.js"></script>
  <script>
    // Connection status check
    async function checkStatus() {
      try {
        const status = await window.electronAPI.checkBackend();
        const statusEl = document.getElementById('status');
        const indicator = statusEl.querySelector('.status-indicator');
        const text = statusEl.querySelector('.status-text');
        
        if (status.connected) {
          indicator.style.background = '#2ecc71';
          text.textContent = 'Connected';
        } else {
          indicator.style.background = '#e74c3c';
          text.textContent = 'Disconnected';
        }
      } catch (error) {
        console.error('Status check failed:', error);
      }
    }

    // Check status every 5 seconds
    checkStatus();
    setInterval(checkStatus, 5000);

    // Category filtering
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const category = btn.dataset.category;
        filterWorkflows(category);
      });
    });

    function filterWorkflows(category) {
      const cards = document.querySelectorAll('.workflow-card');
      cards.forEach(card => {
        if (category === 'all') {
          card.style.display = 'block';
        } else {
          const cardCategory = card.querySelector('.workflow-category').textContent.toLowerCase();
          card.style.display = cardCategory === category ? 'block' : 'none';
        }
      });
    }

    // Create custom workflow button
    document.getElementById('createWorkflowBtn')?.addEventListener('click', () => {
      alert('Custom workflow creation coming soon!');
    });
  </script>
</body>
</html>
